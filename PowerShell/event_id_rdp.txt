Поиск подключений по RDP в журнале событий Windows
В Windows существует несколько способов отследить подключения по RDP через журнал событий. Ниже приведены два наиболее распространенных метода:
Метод 1: Использование журнала безопасности
Откройте "Просмотр событий": Нажмите Win + R, введите eventvwr.msc и нажмите Enter.
Перейдите к журналу безопасности: В левой панели разверните "Журналы Windows" и выберите "Безопасность".
Фильтр событий: В правой панели нажмите "Фильтровать текущий журнал".
Укажите источник событий: В поле "Источники событий" выберите "Microsoft-Windows-TerminalServices-RemoteConnectionManager".
Выберите коды событий: В поле "Включает/исключает ID событий" введите следующие коды, разделенные запятыми:
1149: Успешное подключение RDP.
1150: Отключение RDP.
1152: Ошибка при подключении RDP.
Укажите временной диапазон: В разделе "Зарегистрировано" выберите нужный период времени.
Примените фильтр: Нажмите "ОК", чтобы применить фильтр и просмотреть список событий.
Анализ событий: В списке событий вы увидите информацию о каждом подключении RDP, включая имя пользователя, IP-адрес, время подключения и отключения.
Метод 2: Использование PowerShell
Запустите PowerShell: Нажмите Win + X и выберите "Windows PowerShell (Администратор)".
Выполните команду: Введите следующую команду, заменив <StartDate> и <EndDate> на нужные даты и время в формате "гггг-мм-дд чч:мм:сс":
Get-WinEvent -FilterHashtable @{LogName='Security';ID=1149;StartTime='<StartDate>';EndTime='<EndDate>'} | Format-List TimeCreated, UserID, Message
Use code with caution.
Powershell
Анализ результатов: Команда выведет список событий успешных подключений RDP с указанием времени, имени пользователя и IP-адреса.
Дополнительные советы:
Для более детальной информации о подключении, можно дважды кликнуть по событию в журнале.
Вы можете использовать другие коды событий для поиска информации о неудачных подключениях или отключенных сеансах.
В PowerShell можно использовать дополнительные параметры для фильтрации событий по имени пользователя, IP-адресу и другим критериям.
Важно:
Для просмотра журналов безопасности требуются права администратора.
Регулярно очищайте журналы событий, чтобы избежать их переполнения.
